<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>ABC College — Book Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #f5f7fb;
      --panel: rgba(255,255,255,0.96);
      --border: #e5e7eb;
      --text: #1f2937;
      --muted: #6b7280;
      --primary: #0d6efd;
      --primary-600: #0b5ed7;
      --danger: #dc3545;
      --danger-600: #bb2d3b;
      --success: #198754;
      --success-600: #157347;
      --price: #0f766e;
      --shadow: 0 6px 24px rgba(0,0,0,0.08);
    }

    html, body { height: 100%; scroll-behavior: smooth; }
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, Arial, sans-serif;
      color: var(--text);
      background-color: var(--bg);
      /* Page background image (no-repeat) */
      background-image: url('https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1600&q=60');
      background-repeat: no-repeat;
      background-size: cover;
      background-attachment: fixed;
    }

    /* Link states */
    a:link { color: var(--primary); }
    a:visited { color: #6f42c1; }
    a:hover { color: var(--primary-600); text-decoration: underline; }
    a:active { color: #084298; }

    /* Header */
    .header {
      position: sticky; top: 0; z-index: 10;
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 16px;
      background: rgba(255,255,255,0.9);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(6px);
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .brand-logo { width: 44px; height: 44px; border-radius: 8px; }
    .brand-text { display: flex; flex-direction: column; }
    .brand-name { font-weight: 800; font-size: 20px; letter-spacing: 0.3px; }
    .brand-subtitle { color: var(--muted); font-size: 12px; }
    .top-links a { margin-left: 12px; text-decoration: none; font-weight: 600; }
    .top-links a.disabled { opacity: 0.5; pointer-events: none; }

    .container { max-width: 1100px; margin: 16px auto; padding: 0 12px; }

    /* Panel with background texture (repeat) */
    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: var(--shadow);
      background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      background-repeat: repeat; /* single element background-repeat demo */
    }

    .catalogue-header {
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
    }
    .branch-switcher { display: flex; align-items: center; gap: 8px; }

    /* Forms */
    .form-row { display: grid; grid-template-columns: 180px 1fr; gap: 10px; align-items: center; margin: 10px 0; }
    .form-row label { font-weight: 600; }
    .form-row input, .form-row select, .form-row textarea {
      padding: 8px 10px; border: 1px solid var(--border); border-radius: 8px; background: #fff;
    }
    .form-actions { margin-top: 6px; display: flex; gap: 10px; flex-wrap: wrap; }
    .error { color: var(--danger); font-size: 0.9em; min-height: 1.2em; }
    .muted { color: var(--muted); }
    .small { font-size: 0.9em; }

    /* Buttons */
    .btn { padding: 8px 12px; border-radius: 8px; border: 1px solid var(--border); background: #fff; cursor: pointer; }
    .btn:hover { background: #f8fafc; }
    .btn-compact { padding: 4px 8px; }
    .btn-primary { background: var(--primary); color: #fff; border-color: var(--primary); }
    .btn-primary:hover { background: var(--primary-600); }
    .btn-danger { background: var(--danger); color: #fff; border-color: var(--danger); }
    .btn-danger:hover { background: var(--danger-600); }
    .btn-success { background: var(--success); color: #fff; border-color: var(--success); }
    .btn-success:hover { background: var(--success-600); }
    .btn-link { background: transparent; border: none; color: var(--primary); padding: 0 4px; }
    .btn-link:hover { text-decoration: underline; background: transparent; }

    /* Tables */
    .books { width: 100%; border-collapse: collapse; }
    .books th, .books td { padding: 10px; border-bottom: 1px solid var(--border); text-align: left; vertical-align: middle; }
    .books thead th { background: #f1f5f9; }
    .price { font-weight: 700; color: var(--price); }
    .total-label { text-align: right; font-weight: 600; }
    .total-label.grand, .price.grand { font-size: 1.1em; }

    .cart-item { display: flex; align-items: center; gap: 10px; }
    .cart-title { font-weight: 600; }
    .qty-cell { white-space: nowrap; }

    /* Utility */
    .hidden { display: none !important; }

    /* Modal */
    .modal { position: fixed; inset: 0; display: none; }
    .modal:not(.hidden) { display: block; }
    .modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.35); }
    .modal-dialog {
      position: relative; z-index: 2;
      max-width: 520px; margin: 12vh auto; background: #fff;
      border-radius: 12px; border: 1px solid var(--border);
      padding: 16px; box-shadow: var(--shadow);
    }

    /* Footer */
    .footer { padding: 20px 0 40px; text-align: center; color: var(--muted); }
  </style>
</head>
<body>
  <header class="header">
    <div class="brand">
      <img class="brand-logo" src="https://img.icons8.com/fluency/48/graduation-cap.png" alt="College Logo">
      <div class="brand-text">
        <div class="brand-name">ABC College</div>
        <div class="brand-subtitle">Official Book Store</div>
      </div>
    </div>
    <nav class="top-links">
      <a href="#login-section">Login</a>
      <a href="#catalogue-section" id="nav-catalogue" class="disabled" aria-disabled="true">Catalogue</a>
      <a href="#cart-section" id="nav-cart" class="disabled" aria-disabled="true">Cart</a>
    </nav>
  </header>

  <main class="container">
    <!-- Login Section -->
    <section id="login-section" class="panel">
      <h2>Login</h2>
      <form id="login-form" novalidate>
        <div class="form-row">
          <label for="username">Username</label>
          <input id="username" name="username" type="text" placeholder="Enter username" required>
          <div class="error" id="username-error"></div>
        </div>
        <div class="form-row">
          <label for="password">Password</label>
          <input id="password" name="password" type="password" placeholder="Enter password" required>
          <div class="error" id="password-error"></div>
        </div>
        <div class="form-row">
          <label for="branch">Branch</label>
          <select id="branch" name="branch" required>
            <option value="" disabled selected>Select branch</option>
            <option value="CSE">CSE</option>
            <option value="ECE">ECE</option>
            <option value="EEE">EEE</option>
            <option value="CIVIL">CIVIL</option>
          </select>
          <div class="error" id="branch-error"></div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Login</button>
          <button type="reset" class="btn">Reset</button>
          <button type="button" class="btn btn-link" id="forgot-link">Forgot password?</button>
        </div>
      </form>
      <p class="muted small">This demo validates inputs locally; no server is required.</p>
    </section>

    <!-- Catalogue Section (hidden until login) -->
    <section id="catalogue-section" class="panel hidden">
      <div class="catalogue-header">
        <div>
          <h2>Catalogue — <span id="current-branch">CSE</span></h2>
          <div class="muted">Welcome, <span id="greeting-username">Guest</span>!</div>
        </div>
        <div class="branch-switcher">
          <label for="branch-select">Change branch</label>
          <select id="branch-select">
            <option value="CSE">CSE</option>
            <option value="ECE">ECE</option>
            <option value="EEE">EEE</option>
            <option value="CIVIL">CIVIL</option>
          </select>
        </div>
      </div>

      <table class="books" id="catalogue-table" aria-label="Books Catalogue">
        <thead>
          <tr>
            <th>Cover</th>
            <th>Book</th>
            <th>Author</th>
            <th>Publisher</th>
            <th>Price</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="catalogue-body">
          <!-- Filled by JS -->
        </tbody>
      </table>
    </section>

    <!-- Cart Section (visible after login) -->
    <section id="cart-section" class="panel hidden">
      <h2>Your Cart</h2>
      <p id="cart-empty" class="muted">Your cart is empty.</p>
      <table class="books" id="cart-table" aria-label="Cart Table">
        <thead>
          <tr>
            <th>Item</th>
            <th>Branch</th>
            <th>Qty</th>
            <th>Unit Price</th>
            <th>Line Total</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="cart-items">
          <!-- Filled by JS -->
        </tbody>
        <tfoot>
          <tr>
            <td colspan="4" class="total-label">Subtotal</td>
            <td class="price" id="subtotal">$0.00</td>
            <td></td>
          </tr>
          <tr>
            <td colspan="4" class="total-label">Tax (5%)</td>
            <td class="price" id="tax">$0.00</td>
            <td></td>
          </tr>
          <tr>
            <td colspan="4" class="total-label grand">Grand Total</td>
            <td class="price grand" id="grand-total">$0.00</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
      <div class="form-actions">
        <button type="button" class="btn btn-danger" id="clear-cart">Clear Cart</button>
        <button type="button" class="btn btn-success" id="checkout">Checkout</button>
      </div>
    </section>
  </main>

  <!-- Forgot Password Modal -->
  <div id="forgot-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="forgot-title">
    <div class="modal-backdrop" data-close="true"></div>
    <div class="modal-dialog">
      <h3 id="forgot-title">Reset Password</h3>
      <p class="muted small">Enter your email or username. We’ll simulate sending a reset link.</p>
      <form id="forgot-form">
        <div class="form-row">
          <label for="forgot-identifier">Email or Username</label>
          <input id="forgot-identifier" name="identifier" type="text" placeholder="name@domain.com or username" required>
          <div class="error" id="forgot-error"></div>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Send reset link</button>
          <button type="button" class="btn" data-close="true">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <footer class="footer">
    <div class="container small muted">
      © <span id="year"></span> ABC College Book Store — Demo single-page site
    </div>
  </footer>

  <script>
    (function () {
      'use strict';

      // Demo data by branch
      const BOOKS = {
        CSE: [
          { id: 'ai', title: 'AI', author: 'S. Russel', publisher: 'Prentice Hall', price: 63.0, img: 'https://picsum.photos/seed/ai/80/100' },
          { id: 'java-2', title: 'Java 2', author: 'Watson', publisher: 'BPB Publications', price: 35.5, img: 'https://picsum.photos/seed/java/80/100' },
          { id: 'html-24', title: 'HTML in 24 Hours', author: 'Sam Peter', publisher: 'Sam Publication', price: 50.0, img: 'https://picsum.photos/seed/html/80/100' },
          { id: 'xml-bible', title: 'XML Bible', author: 'Winston', publisher: 'Wiley', price: 40.5, img: 'https://picsum.photos/seed/xml/80/100' }
        ],
        ECE: [
          { id: 'dsp', title: 'Digital Signal Processing', author: 'Proakis', publisher: 'McGraw-Hill', price: 48.0, img: 'https://picsum.photos/seed/dsp/80/100' },
          { id: 'vlsi', title: 'VLSI Design', author: 'S. Kang', publisher: 'Tata McGraw-Hill', price: 45.0, img: 'https://picsum.photos/seed/vlsi/80/100' }
        ],
        EEE: [
          { id: 'machines', title: 'Electrical Machines', author: 'P. S. Bimbhra', publisher: 'Khanna', price: 50.0, img: 'https://picsum.photos/seed/machines/80/100' },
          { id: 'power', title: 'Power Systems', author: 'C. L. Wadhwa', publisher: 'New Age', price: 55.0, img: 'https://picsum.photos/seed/power/80/100' }
        ],
        CIVIL: [
          { id: 'struct', title: 'Structural Analysis', author: 'R. C. Hibbeler', publisher: 'Pearson', price: 60.0, img: 'https://picsum.photos/seed/struct/80/100' },
          { id: 'concrete', title: 'Concrete Technology', author: 'M. S. Shetty', publisher: 'S. Chand', price: 40.0, img: 'https://picsum.photos/seed/concrete/80/100' }
        ]
      };

      const TAX_RATE = 0.05;

      // State (persisting only the cart)
      function getCart() {
        try { return JSON.parse(localStorage.getItem('cart')) || []; } catch { return []; }
      }
      function setCart(cart) { localStorage.setItem('cart', JSON.stringify(cart)); }

      // Helpers
      function $(sel) { return document.querySelector(sel); }
      function $all(sel) { return Array.from(document.querySelectorAll(sel)); }
      function money(n) { return '$' + (Number(n) || 0).toFixed(2); }
      function show(el) { el.classList.remove('hidden'); }
      function hide(el) { el.classList.add('hidden'); }

      // Login flow
      function handleLoginSubmit(e) {
        e.preventDefault();
        clearLoginErrors();

        const username = $('#username').value.trim();
        const password = $('#password').value;
        const branch = $('#branch').value;

        let ok = true;
        if (username.length < 3) { $('#username-error').textContent = 'Username must be at least 3 characters.'; ok = false; }
        if (password.length < 6) { $('#password-error').textContent = 'Password must be at least 6 characters.'; ok = false; }
        if (!branch) { $('#branch-error').textContent = 'Please select your branch.'; ok = false; }
        if (!ok) return;

        // Simulate successful login
        $('#greeting-username').textContent = username;
        $('#current-branch').textContent = branch;
        $('#branch-select').value = branch;

        hide($('#login-section'));
        show($('#catalogue-section'));
        show($('#cart-section'));

        // Enable nav
        enableNavLinks();

        renderCatalogue(branch);
        renderCart();
      }

      function enableNavLinks() {
        ['#nav-catalogue', '#nav-cart'].forEach(sel => {
          const link = $(sel);
          link.classList.remove('disabled');
          link.removeAttribute('aria-disabled');
        });
      }

      function clearLoginErrors() {
        ['#username-error', '#password-error', '#branch-error'].forEach(sel => { $(sel).textContent = ''; });
      }

      // Catalogue rendering
      function renderCatalogue(branch) {
        const tbody = $('#catalogue-body');
        const data = BOOKS[branch] || [];
        tbody.innerHTML = '';
        data.forEach(book => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td><img src="${book.img}" alt="${book.title}" width="48" height="64"></td>
            <td>${book.title}</td>
            <td>${book.author}</td>
            <td>${book.publisher}</td>
            <td class="price">${money(book.price)}</td>
            <td><button class="btn btn-primary add-btn" data-id="${book.id}" data-branch="${branch}">Add to cart</button></td>
          `;
          tbody.appendChild(tr);
        });

        // Attach add-to-cart handlers
        $all('.add-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const id = btn.getAttribute('data-id');
            const br = btn.getAttribute('data-branch');
            const book = (BOOKS[br] || []).find(b => b.id === id);
            if (book) addToCart({ ...book, branch: br });
          });
        });

        $('#current-branch').textContent = branch;
      }

      // Cart operations
      function addToCart(item) {
        const cart = getCart();
        const idx = cart.findIndex(x => x.id === item.id && x.branch === item.branch);
        if (idx >= 0) {
          cart[idx].qty = (cart[idx].qty || 1) + 1;
        } else {
          cart.push({ id: item.id, title: item.title, price: item.price, qty: 1, author: item.author, publisher: item.publisher, img: item.img, branch: item.branch });
        }
        setCart(cart);
        renderCart();
      }

      function changeQty(id, branch, delta) {
        const cart = getCart();
        const idx = cart.findIndex(x => x.id === id && x.branch === branch);
        if (idx >= 0) {
          cart[idx].qty = Math.max(1, (cart[idx].qty || 1) + delta);
          setCart(cart);
          renderCart();
        }
      }

      function removeItem(id, branch) {
        const cart = getCart().filter(x => !(x.id === id && x.branch === branch));
        setCart(cart);
        renderCart();
      }

      function clearCart() {
        setCart([]);
        renderCart();
      }

      function renderCart() {
        const cart = getCart();
        const tbody = $('#cart-items');
        const empty = $('#cart-empty');
        tbody.innerHTML = '';

        if (cart.length === 0) {
          empty.style.display = 'block';
        } else {
          empty.style.display = 'none';
        }

        let subtotal = 0;
        cart.forEach(item => {
          const line = (item.qty || 1) * (Number(item.price) || 0);
          subtotal += line;

          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>
              <div class="cart-item">
                <img src="${item.img}" alt="${item.title}" width="40" height="54">
                <div>
                  <div class="cart-title">${item.title}</div>
                  <div class="muted small">${item.author} — ${item.publisher}</div>
                </div>
              </div>
            </td>
            <td>${item.branch}</td>
            <td class="qty-cell">
              <button class="btn btn-compact" data-action="dec" data-id="${item.id}" data-branch="${item.branch}">−</button>
              <span class="qty">${item.qty || 1}</span>
              <button class="btn btn-compact" data-action="inc" data-id="${item.id}" data-branch="${item.branch}">+</button>
            </td>
            <td class="price">${money(item.price)}</td>
            <td class="price">${money(line)}</td>
            <td><button class="btn btn-danger btn-compact" data-action="remove" data-id="${item.id}" data-branch="${item.branch}">Remove</button></td>
          `;
          tbody.appendChild(tr);
        });

        // Totals
        const tax = subtotal * TAX_RATE;
        const grand = subtotal + tax;
        $('#subtotal').textContent = money(subtotal);
        $('#tax').textContent = money(tax);
        $('#grand-total').textContent = money(grand);

        // Delegated handlers for qty/change/remove
        tbody.querySelectorAll('button[data-action]').forEach(btn => {
          const id = btn.getAttribute('data-id');
          const branch = btn.getAttribute('data-branch');
          const action = btn.getAttribute('data-action');

          if (action === 'inc') btn.addEventListener('click', () => changeQty(id, branch, +1));
          if (action === 'dec') btn.addEventListener('click', () => changeQty(id, branch, -1));
          if (action === 'remove') btn.addEventListener('click', () => removeItem(id, branch));
        });
      }

      // Forgot password modal
      function openForgot() {
        $('#forgot-identifier').value = '';
        $('#forgot-error').textContent = '';
        show($('#forgot-modal'));
      }
      function closeForgot() { hide($('#forgot-modal')); }
      function handleForgotSubmit(e) {
        e.preventDefault();
        const value = $('#forgot-identifier').value.trim();
        if (!value) {
          $('#forgot-error').textContent = 'Please enter your email or username.';
          return;
        }
        closeForgot();
        alert('If this were connected to a server, a reset link would be sent to: ' + value);
      }

      // Events
      function wireEvents() {
        $('#login-form').addEventListener('submit', handleLoginSubmit);
        $('#branch-select').addEventListener('change', e => renderCatalogue(e.target.value));
        $('#clear-cart').addEventListener('click', clearCart);
        $('#checkout').addEventListener('click', () => {
          const total = $('#grand-total').textContent;
          alert('Checkout successful.\\nTotal billed: ' + total + '\\n\\n(This is a demo; no payment is processed.)');
          clearCart();
        });

        // Forgot modal open/close
        $('#forgot-link').addEventListener('click', openForgot);
        $('#forgot-form').addEventListener('submit', handleForgotSubmit);
        document.addEventListener('click', (e) => {
          const tgt = e.target;
          if (tgt && (tgt.getAttribute('data-close') === 'true')) closeForgot();
        });

        // Footer year
        const y = new Date().getFullYear();
        const yearEl = document.getElementById('year');
        if (yearEl) yearEl.textContent = y;
      }

      // Init
      document.addEventListener('DOMContentLoaded', () => {
        wireEvents();
      });
    })();
  </script>
</body>
</html>